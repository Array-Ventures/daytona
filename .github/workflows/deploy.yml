name: Deploy to Hostinger VPS

on:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v5

      - name: Deploy to Hostinger
        uses: hostinger/deploy-on-vps@v2
        with:
          api-key: ${{ secrets.HOSTINGER_API_KEY }}
          virtual-machine: ${{ vars.HOSTINGER_VM_ID }}
          project-name: daytona
          docker-compose-path: docker/docker-compose.yaml
          environment-variables: |
            PORT=${{ vars.PORT }}
            PROXY_PORT=${{ vars.PROXY_PORT }}
            MINIO_PORT=${{ vars.MINIO_PORT }}
            PUBLIC_OIDC_DOMAIN=${{ vars.PUBLIC_OIDC_DOMAIN }}
            DASHBOARD_URL=${{ vars.DASHBOARD_URL }}
            DASHBOARD_BASE_API_URL=${{ vars.DASHBOARD_BASE_API_URL }}
            DEX_ISSUER=${{ vars.DEX_ISSUER }}
            DEX_REDIRECT_URI=${{ vars.DEX_REDIRECT_URI }}
            PROXY_DOMAIN=${{ vars.PROXY_DOMAIN }}
            PROXY_PROTOCOL=${{ vars.PROXY_PROTOCOL }}
